<div class="orders-management">
  <!-- Enhanced Page Header -->
  <div class="page-header">
    <div class="header-content">
      <div class="header-info">
        <h1 class="text-light">
          <i class="fas fa-chart-bar"></i>
          Orders Analytics
        </h1>
        <p>Comprehensive order statistics and performance analytics</p>
        <div class="quick-stats">
          <div class="stat-item">
            <span class="stat-value">{{ formatNumber(orderStats.totalOrders) }}</span>
            <span class="stat-label">Total Orders</span>
          </div>
          <div class="stat-item">
            <span class="stat-value">{{ formatCurrency(orderStats.totalRevenue) }}</span>
            <span class="stat-label">Total Revenue</span>
          </div>
          <div class="stat-item">
            <span class="stat-value">{{ getCompletionRate().toFixed(1) }}%</span>
            <span class="stat-label">Completion Rate</span>
          </div>
        </div>
      </div>
      <div class="header-actions">
        <button class="btn btn-outline-light bg-light text-dark " (click)="refreshStats()" [disabled]="isLoading">
          <i class="fas fa-sync" [class.fa-spin]="isLoading"></i>
          Refresh Data
        </button>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="alert alert-danger alert-dismissible">
    <i class="fas fa-exclamation-triangle"></i>
    {{ errorMessage }}
    <button type="button" class="btn-close" (click)="errorMessage = ''"></button>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="loading-content">
      <div class="loading-spinner"></div>
      <h3>Loading order statistics...</h3>
      <p>Please wait while we fetch the analytics data</p>
    </div>
  </div>

  <!-- Statistics Dashboard -->
  <div *ngIf="!isLoading" class="stats-dashboard">
    <!-- Primary Stats Cards -->
    <div class="stats-section">
      <div class="section-header">
        <h3>
          <i class="fas fa-chart-line"></i>
          Overview Statistics
          <span class="time-badge">{{ getCurrentTimeLabel() }}</span>
        </h3>
        <p>Key performance indicators and revenue metrics</p>
      </div>
      <div class="stats-grid">
        <div class="stat-card primary">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-shopping-cart"></i>
            </div>
            <div class="stat-trend" [ngClass]="getOrderTrend()">
              <i [class]="getOrderTrendIcon()"></i>
              <span>{{ getOrderTrendValue() }}%</span>
            </div>
          </div>
          <div class="stat-value">{{ formatNumber(orderStats.totalOrders) }}</div>
          <div class="stat-label">Total Orders</div>
          <div class="stat-sublabel">All time orders processed</div>
        </div>

        <div class="stat-card success">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-dollar-sign"></i>
            </div>
            <div class="stat-trend" [ngClass]="getRevenueTrend()">
              <i [class]="getRevenueTrendIcon()"></i>
              <span>{{ getRevenueTrendValue() }}%</span>
            </div>
          </div>
          <div class="stat-value">{{ formatCurrency(orderStats.totalRevenue) }}</div>
          <div class="stat-label">Total Revenue</div>
          <div class="stat-sublabel">Gross revenue generated</div>
        </div>

        <div class="stat-card info">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-calculator"></i>
            </div>
            <div class="stat-trend" [ngClass]="getAOVTrend()">
              <i [class]="getAOVTrendIcon()"></i>
              <span>{{ getAOVTrendValue() }}%</span>
            </div>
          </div>
          <div class="stat-value">{{ formatCurrency(orderStats.avgOrderValue) }}</div>
          <div class="stat-label">Average Order Value</div>
          <div class="stat-sublabel">Per order revenue</div>
        </div>

        <div class="stat-card warning">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-clock"></i>
            </div>
            <div class="stat-trend" [ngClass]="getActiveTrend()">
              <i [class]="getActiveTrendIcon()"></i>
              <span>{{ getActiveTrendValue() }}%</span>
            </div>
          </div>
          <div class="stat-value">{{ formatNumber(orderStats.activeOrders) }}</div>
          <div class="stat-label">Active Orders</div>
          <div class="stat-sublabel">Currently processing</div>
        </div>
      </div>
    </div>

    <!-- Order Status Breakdown -->
    <div class="stats-section">
      <div class="section-header">
        <h3>
          <i class="fas fa-chart-pie"></i>
          Order Status Breakdown
        </h3>
        <p>Distribution of orders by completion status</p>
      </div>
      <div class="stats-grid">
        <div class="stat-card pending">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-hourglass-half"></i>
            </div>
            <div class="stat-percentage">
              <span>{{ getPendingPercentage() }}%</span>
            </div>
          </div>
          <div class="stat-value">{{ formatNumber(orderStats.pendingOrders) }}</div>
          <div class="stat-label">Pending Orders</div>
          <div class="stat-sublabel">Awaiting processing</div>
        </div>

        <div class="stat-card completed">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-percentage">
              <span>{{ getCompletedPercentage() }}%</span>
            </div>
          </div>
          <div class="stat-value">{{ formatNumber(orderStats.completedOrders) }}</div>
          <div class="stat-label">Completed Orders</div>
          <div class="stat-sublabel">Successfully delivered</div>
        </div>

        <div class="stat-card cancelled">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-times-circle"></i>
            </div>
            <div class="stat-percentage">
              <span>{{ getCancelledPercentage() }}%</span>
            </div>
          </div>
          <div class="stat-value">{{ formatNumber(orderStats.cancelledOrders) }}</div>
          <div class="stat-label">Cancelled Orders</div>
          <div class="stat-sublabel">Cancelled by users</div>
        </div>

        <div class="stat-card rate">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-percentage"></i>
            </div>
            <div class="stat-trend" [ngClass]="getCompletionTrend()">
              <i [class]="getCompletionTrendIcon()"></i>
              <span>{{ getCompletionTrendValue() }}%</span>
            </div>
          </div>
          <div class="stat-value">{{ getCompletionRate().toFixed(1) }}%</div>
          <div class="stat-label">Completion Rate</div>
          <div class="stat-sublabel">Success rate</div>
        </div>
      </div>
    </div>

    <!-- Performance Metrics -->
    <div class="stats-section">
      <div class="section-header">
        <h3>
          <i class="fas fa-tachometer-alt"></i>
          Performance Metrics
        </h3>
        <p>Time-based performance indicators</p>
      </div>
      <div class="stats-grid">
        <div class="stat-card daily">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-calendar-day"></i>
            </div>
            <div class="stat-trend" [ngClass]="getDailyTrend()">
              <i [class]="getDailyTrendIcon()"></i>
              <span>{{ getDailyTrendValue() }}%</span>
            </div>
          </div>
          <div class="stat-value">{{ formatNumber(orderStats.ordersToday) }}</div>
          <div class="stat-label">Orders Today</div>
          <div class="stat-sublabel">{{ formatCurrency(orderStats.revenueToday) }} revenue</div>
        </div>

        <div class="stat-card monthly">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="stat-trend" [ngClass]="getMonthlyTrend()">
              <i [class]="getMonthlyTrendIcon()"></i>
              <span>{{ getMonthlyTrendValue() }}%</span>
            </div>
          </div>
          <div class="stat-value">{{ formatNumber(orderStats.monthlyOrders) }}</div>
          <div class="stat-label">Monthly Orders</div>
          <div class="stat-sublabel">{{ formatCurrency(orderStats.monthlyRevenue) }} revenue</div>
        </div>

        <div class="stat-card top-restaurant">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-crown"></i>
            </div>
            <div class="stat-rank">
              <span>#1</span>
            </div>
          </div>
          <div class="stat-value-text">{{ orderStats.topRestaurant }}</div>
          <div class="stat-label">Top Restaurant</div>
          <div class="stat-sublabel">Most orders this period</div>
        </div>

        <div class="stat-card cancel-rate">
          <div class="stat-header">
            <div class="stat-icon">
              <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="stat-trend" [ngClass]="getCancelTrend()">
              <i [class]="getCancelTrendIcon()"></i>
              <span>{{ getCancelTrendValue() }}%</span>
            </div>
          </div>
          <div class="stat-value">{{ getCancellationRate().toFixed(1) }}%</div>
          <div class="stat-label">Cancellation Rate</div>
          <div class="stat-sublabel">{{ formatNumber(orderStats.cancelledOrders) }} cancelled</div>
        </div>
      </div>
    </div>
  </div>
</div>